export const metadata = {
  title: 'Commonly used git commands',
  description: ''
}

# Git é…ç½®ã€å·¥å…·ä¸ä½¿ç”¨æ¡ˆä¾‹

## init

```bash
git init
```

---

## config - é…ç½®

### å…¨å±€é…ç½®

```bash
# è®¾ç½®é»˜è®¤ä¸»åˆ†æ”¯å
git config --global initi.defaultbranch main
# ä¿®æ”¹å½“å‰åˆ†æ”¯åä¸º main
git branch -m main

# å…¨å±€é…ç½® #
git config --global user.name "zhuyudong"
git config --global user.email "zhuyudong@aliyun.com"
# ä¿®æ”¹ç”¨æˆ·åå’Œé‚®ç®±åä¿®æ”¹åˆšæ‰çš„æäº¤ï¼Œä½¿ç”¨æœ€æ–°çš„ç”¨æˆ·ä¿¡æ¯
git commit --amend --reset-author

# æé«˜ç¼“å†²åŒºå¤§å°
git config --global ssh.postBuffer 100000000
git config --global http.postBuffer 100000000

# åˆ‡æ¢ http ç‰ˆæœ¬
git config --global http.version HTTP/1.1
git config --global http.version HTTP/2

# ä¸åŒºåˆ†æ–‡ä»¶åå¤§å°å†™
git config core.ignorecase false
# é»˜è®¤ pull ä»£ç æ—¶ä»¥ rebase ç­–ç•¥åˆå¹¶ä»£ç 
git config pull.rebase true
# æŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
git config --get core.ignorecase

# fatal: unable to access 'xxx': gnutls_handshake() failed: Error in the pull function.
git config --global --unset http.proxy
git config --global --unset https.proxy

# åˆ—å‡ºæ‰€æœ‰é…ç½®
git config --list
# åˆ—å‡ºæœ¬ä»“åº“é…ç½®
git config --local --list
# åˆ—å‡ºå…¨å±€é…ç½®
git config --global --list
# åˆ—å‡ºç³»ç»Ÿé…ç½®
git config --system --list
```

### æ ¸å¿ƒé…ç½®

```bash
# è®¾ç½®å¯¹å¤§å°å†™æ•æ„Ÿ
git config --global core.ignorecase false
# ä½¿ç”¨ vim ä½œä¸ºç¼–è¾‘å™¨
git config --global core.editor "vim"

# è¿œç¨‹åˆ†æ”¯å’Œæœ¬åœ°åˆ†æ”¯åˆå¹¶ç­–ç•¥
# [recommend]
git config --global pull.rebase true # rebase
git config pull.rebase false # merge
git config pull.ff only # fast-forward only
```

### åˆ—å‡ºé…ç½®

```bash
# åˆ—å‡ºæ‰€æœ‰é…ç½®
git config --list
# åˆ—å‡ºæœ¬ä»“åº“é…ç½®
git config --local --list
# åˆ—å‡ºå…¨å±€é…ç½®
git config --global --list
# åˆ—å‡ºç³»ç»Ÿé…ç½®
git config --system --list
```

### é­”æ³•é…ç½®

```bash
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"

git lg
```

---

## remote - è¿œç¨‹ä»“åº“

```bash
git remote -v
# æ·»åŠ è¿œç¨‹åœ°å€å¹¶å‘½å (remote name)ï¼Œå¦‚ origin
git remote add <remote name> <git url>
# é‡å‘½åè¿œç¨‹ä»“åº“å
git remote rename <old name> <new name>
# ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€
git remote set-url <remote name> <new git url>
# ä¿®æ”¹ä»“åº“åœ°å€
git remote set-url origin git@gitlab.pegasus.tech:pbdata/skyline.git
```

---

## fetch - æ‹‰å–

```bash
# å°†è¿œç¨‹åˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°åˆ†æ”¯
git fetch origin <remote-branch-name>:<local-branch-name>

# å–å›æ‰€æœ‰è¿œç¨‹åˆ†æ”¯
git fetch
# å–ç‰¹å®šåˆ†æ”¯
git fetch origin :<local-branch-name>
# alias
git fetch origin master:<local-branch-name>
```

---

## pull - æ‹‰å–å¹¶åˆå¹¶

```bash
# é»˜è®¤ pull ä»£ç æ—¶ä»¥ rebase ç­–ç•¥åˆå¹¶ä»£ç 
git config pull.rebase true
git clone https://github.com/zhuyudong/dify.git --depth 1
```

---

## branch - åˆ†æ”¯

### æŸ¥çœ‹åˆ†æ”¯

```bash
# æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯
git branch
# æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯
git branch -r
# æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯
git branch -a
```

### åˆ‡æ¢åˆ†æ”¯

```bash
git checkout <branch-name>
# æŸ¥çœ‹å¹¶æ–°å»ºåˆ†æ”¯
git checkout -b <branch-name>
# æ‹‰å–è¿œç¨‹åˆ†æ”¯å¹¶åˆ›å»ºæœ¬åœ°åˆ†æ”¯
git checkout -b <local-branch-name> origin/<remote-branch-name>

# å¼ºåˆ¶åˆ‡åˆ†æ”¯
git checkout <branch-name> -f
# alias
git fetch origin <remote-branch-name>:<local-branch-name>
```

### è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯

```bash
# å¦‚æœè¿œç¨‹å­˜åœ¨è¿™ä¸ªåˆ†æ”¯åˆ™æœ¬åœ°è·Ÿè¸ªè¿™ä¸ªè¿œç¨‹åˆ†æ”¯
git branch --set-upstream-to=origin/main main
# å¦‚æœè¿œç¨‹ä¸å­˜åœ¨è¿™ä¸ªåˆ†æ”¯ï¼Œåˆ™è¿œç¨‹æ–°å»ºè¿™ä¸ªåˆ†æ”¯å¹¶æ¨é€ä¸Šå»
git push --set-upstream origin main
```

### åŒæ­¥åˆ†æ”¯åˆ—è¡¨

```bash
git fetch -p
```

### åˆ é™¤åˆ†æ”¯

```bash
# åˆ é™¤æœ¬åœ°åˆ†æ”¯
git branch -d <branch-name>
# å¼ºåˆ¶åˆ é™¤æœ¬åœ°åˆ†æ”¯
# error: The branch 'feat/curate' is not fully merged.
# If you are sure you want to delete it, run 'git branch -D feat/curate'.
git banch -D <branch-name>
# åˆ é™¤è¿œç¨‹åˆ†æ”¯
git push origin --delete <branch-name>
# alias
git push origin -d <branch-name>
# åˆ é™¤è¿œç¨‹åˆ†æ”¯
git push origin :<branch-name>
```

### é‡å‘½ååˆ†æ”¯

```bash
# é‡å‘½åæœ¬åœ°åˆ†æ”¯
git branch -m <oldbranch-name> <newbranch-name>
# åˆ é™¤è¿œç¨‹åˆ†æ”¯
git push origin --delete <oldbranch-name>
# æ¨é€è‡³è¿œç¨‹æ–°åˆ†æ”¯
git push origin -u <newbranch-name>
# å°†æœ¬åœ°ä»“åº“åˆ†æ”¯å’Œè¿œç¨‹ä»“åº“åˆ†æ”¯ç»‘å®š
git branch --set-upstream-to=origin/<new-branch-name> <new-branch-name>

# é‡å‘½åæœ¬åœ°åˆ†æ”¯ #
git checkout <old branch name>
# ä¿®æ”¹ä¸ºæ–°åˆ†æ”¯å
git branch -m <new branch name>
# æ¨é€åˆ°è¿œç¨‹æ–°åˆ†æ”¯
git push origin -u <new branch name>
# åˆ é™¤è¿œç¨‹æ—§åˆ†æ”¯
git push origin --delete <branch name>
# or
git push origin -d <branch name>

# å°†å½“å‰åˆ†æ”¯é‡å‘½åä¸º main
git branch -M main
```

### åˆ†æ”¯åˆå¹¶ä¿¡æ¯

```bash
# æŸ¥çœ‹å“ªäº›åˆ†æ”¯å·²ç»åˆå¹¶åˆ°å½“å‰åˆ†æ”¯
git branch --merged
# æŸ¥çœ‹å“ªäº›åˆ†æ”¯è¿˜æ²¡æœ‰åˆå¹¶åˆ°å½“å‰åˆ†æ”¯
git branch --no-merged
```

### åˆ†æ”¯ä¿¡æ¯

```bash
# æŸ¥çœ‹å„ä¸ªåˆ†æ”¯æœ€åä¸€ä¸ªæäº¤å¯¹è±¡çš„ä¿¡æ¯
git branch -v
```

---

## add - æš‚å­˜

æäº¤åˆ°æš‚å­˜åŒº

```bash
# å°†å½“å‰ç›®å½•å†…çš„æ‰€æœ‰æ”¹åŠ¨æ·»åŠ åˆ°æš‚å­˜åŒº
git add .
# å°†å½“å‰ä»“åº“æ‰€æœ‰çš„æ–‡ä»¶æ”¹åŠ¨éƒ½æ·»åŠ åˆ°æš‚å­˜åŒº
git add -A
# æˆ–è€…æŒ‡å®šæ–‡ä»¶
git add src/index.tsx
```

ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡ commit message

```bash
git commit --amend
```

---

## commit - æäº¤

æäº¤åˆ°æœ¬åœ°ä»“åº“

```bash
# åœ¨ GitHub/GitLab æ–°å»ºä¸€ä¸ªä»“åº“å #
git clone <giturl>
# NOTE: --depth 1 æé«˜ä¸‹è½½é€Ÿåº¦
git clone https://github.com/markmead/hyperui.git --depth 1
cd <foldname>
git switch -c master
touch README.md
git add README.md
git commit -m "chore: Initial commit"

# å°†å·²æœ‰çš„æ–‡ä»¶å¤¹å…³è”åˆ°å·²æ–°å»ºä»“åº“ #
cd <foldname>
git init --initial-branch=master
git remote add origin <giturl>
git add .
git commit -m "chore: Initial commit"

# æ¨é€ç°æœ‰ git ä»“åº“ #
cd <foldname>
git remote rename origin old-origin
git remote add origin <giturl>
```

---

## push - æ¨é€åˆ°è¿œç¨‹

æ¨é€åˆ°è¿œç¨‹ä»“åº“

```bash
# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push
# å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ¨é€åˆ™å¦‚ä¸‹ï¼Œå…¶ä¸­ <remote name> <branch name> æ¥è‡ªäºè¿™é‡Œ
# æ¯”å¦‚ origin main
git push -u <remote name> <branch name>
# or
git push --set-upstream <remote name> <branch name>

# æ¨é€æ‰€æœ‰åˆ†æ”¯
git push --all github

# æ¯”å¦‚å°†å½“å‰ main åˆ†æ”¯æ¨é€åˆ°ä»“åº“ master åˆ†æ”¯ä¸Š
git push origin HEAD:master

```

---

## rm - åˆ é™¤æ–‡ä»¶

```bash
# å°†æ–‡ä»¶ä» Git ä»“åº“åˆ é™¤ï¼Œé…åˆ .gitignore
git rm <filename>
# åŒä¸Šï¼Œæ–‡ä»¶å¤¹
git rm -r <folder>
# ä¾‹å¦‚
git rm -r .history
git push
```

---

## diff - æ¯”è¾ƒ

```bash
# æ¯”è¾ƒå·¥ä½œåŒºä¸ç¼“å­˜åŒº
git diff
# æ¯”è¾ƒç¼“å­˜åŒºä¸æœ¬åœ°ä»“åº“æœ€è¿‘ä¸€æ¬¡ commit å†…å®¹
git diff --cached
# æ¯”è¾ƒå·¥ä½œåŒºä¸æœ€è¿‘ä¸€æ¬¡ commit å†…å®¹
git diff HEAD
```

---

## status/log/show - çŠ¶æ€ä¸æ—¥å¿—

```bash
# æŸ¥çœ‹çŠ¶æ€
git status
# æŸ¥çœ‹å†å²æ“ä½œè®°å½•
git reflog
# æŸ¥çœ‹æ—¥å¿—
git log
# æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡ commit è¯¦æƒ…
git show
# æŸ¥çœ‹æŒ‡å®š commit ä¿®æ”¹è¯¦æƒ…
git show <commit id>
# æŸ¥çœ‹æŒ‡å®š commit æ–‡ä»¶ä¿®æ”¹è¯¦æƒ…
git show <commit id> <fileName>

git lg
```

---

## stash - æš‚å­˜æœ¬åœ°ä¿®æ”¹

- [ ] TODO: å¾…è¡¥å……

```bash
# æš‚å­˜æœ¬åœ°ä¿®æ”¹ï¼Œå³è¿˜æœª git add çš„å†…å®¹
git stash
git stash pop
```

---

## merge - åˆå¹¶

```bash
# å½“å‰åˆ†æ”¯ä¸æŒ‡å®šåˆ†æ”¯åˆå¹¶
git merge <branch-name>
# å½“åˆå¹¶æ—¶å‘ç”Ÿå†²çªæ—¶å¯ä»¥ç»ˆæ­¢åˆå¹¶
git merge --abort
```

---

## rebase - åˆå¹¶

**æ³¨æ„ï¼šrebase å‰ç¡®ä¿éƒ½å·²ç» add å’Œ commitï¼Œå¦‚æœæœ‰ä¿®æ”¹å¯ä»¥å…ˆ `git stash`ï¼Œåˆå¹¶ç»“æŸåå† `git stash pop`**

- `git rebase <branch_name>`
- `git cherry-pick <commit hash>` å°†å…¶å®ƒåˆ†æ”¯ä¸Šå·² commit çš„åœ¨å½“å‰åˆ†æ”¯ä¸Šå†æäº¤ä¸€æ¬¡ï¼Œäº§ç”Ÿæ–°çš„ commit

```bash
# ä»HEADç‰ˆæœ¬å¼€å§‹å¾€è¿‡å»æ•°3ä¸ªç‰ˆæœ¬
git rebase -i HEAD~3

# or
# æŒ‡åè¦åˆå¹¶çš„ç‰ˆæœ¬ä¹‹å‰çš„ç‰ˆæœ¬å·
git rebase -i 3a4226b

# or
git rebase
# å°† pick æ”¹ä¸º squash æˆ– s åä¿å­˜é€€å‡ºï¼Œå¦‚æœæœ‰å†²çªï¼Œåˆ™è§£å†³å†²çªå
# å¦‚æœ commit msg å†™é”™äº†ï¼Œå¦‚ squash å†™æˆæ–™ sqaushï¼Œåˆ™æ‰§è¡Œ
git rebase --edit-todo # ç»§ç»­ç¼–è¾‘
# å†²çªéƒ½è§£å†³å®Œåç»§ç»­ rebase
git add .
git rebase --continue
# å¦‚æœæƒ³æ”¾å¼ƒè¿™æ¬¡å‹ç¼©åˆ™
git rebase --abort
# å¦‚æœæ²¡æœ‰å†²çªåˆ™ä¿å­˜é€€å‡º
```

```bash
pick 1bdae02 fix: ğŸ› route definition
pick a064cf6 fix: ğŸ› upgrade msw version
pick bd2d092 chore: ğŸ”§ update project config
pick 70fb95e chore: ğŸ”§ rename
pick 31249bd feat: âœ¨ update storybook
pick 94742d0 fix: ğŸ› upgrade dependencies version & rename & config
pick fe49167 chore: ğŸ”§ format
pick e7786ea feat: âœ¨ loading component
pick 192c380 feat: âœ¨ rename
pick 22bb055 fix: ğŸ› mock

# å˜åŸº 691973d..22bb055 åˆ° e7786eaï¼ˆ10 ä¸ªæäº¤ï¼‰
#
# å‘½ä»¤:
# p, pick <æäº¤> = ä½¿ç”¨æäº¤
# r, reword <æäº¤> = ä½¿ç”¨æäº¤ï¼Œä½†ä¿®æ”¹æäº¤è¯´æ˜
# e, edit <æäº¤> = ä½¿ç”¨æäº¤ï¼Œè¿›å…¥ shell ä»¥ä¾¿è¿›è¡Œæäº¤ä¿®è¡¥
# s, squash <æäº¤> = ä½¿ç”¨æäº¤ï¼Œä½†èåˆåˆ°å‰ä¸€ä¸ªæäº¤
# f, fixup <æäº¤> = ç±»ä¼¼äº "squash"ï¼Œä½†ä¸¢å¼ƒæäº¤è¯´æ˜æ—¥å¿—
# x, exec <å‘½ä»¤> = ä½¿ç”¨ shell è¿è¡Œå‘½ä»¤ï¼ˆæ­¤è¡Œå‰©ä½™éƒ¨åˆ†ï¼‰
# b, break = åœ¨æ­¤å¤„åœæ­¢ï¼ˆä½¿ç”¨ 'git rebase --continue' ç»§ç»­å˜åŸºï¼‰
# d, drop <æäº¤> = åˆ é™¤æäº¤
# l, label <label> = ä¸ºå½“å‰ HEAD æ‰“ä¸Šæ ‡è®°
# t, reset <label> = é‡ç½® HEAD åˆ°è¯¥æ ‡è®°
# m, merge [-C <commit> | -c <commit>] <label> [# <oneline>]
# .       åˆ›å»ºä¸€ä¸ªåˆå¹¶æäº¤ï¼Œå¹¶ä½¿ç”¨åŸå§‹çš„åˆå¹¶æäº¤è¯´æ˜ï¼ˆå¦‚æœæ²¡æœ‰æŒ‡å®š
# .       åŸå§‹æäº¤ï¼Œä½¿ç”¨æ³¨é‡Šéƒ¨åˆ†çš„ oneline ä½œä¸ºæäº¤è¯´æ˜ï¼‰ã€‚ä½¿ç”¨
# .       -c <æäº¤> å¯ä»¥ç¼–è¾‘æäº¤è¯´æ˜ã€‚
#
# å¯ä»¥å¯¹è¿™äº›è¡Œé‡æ–°æ’åºï¼Œå°†ä»ä¸Šè‡³ä¸‹æ‰§è¡Œã€‚
#
# å¦‚æœæ‚¨åœ¨è¿™é‡Œåˆ é™¤ä¸€è¡Œï¼Œå¯¹åº”çš„æäº¤å°†ä¼šä¸¢å¤±ã€‚
#
# ç„¶è€Œï¼Œå¦‚æœæ‚¨åˆ é™¤å…¨éƒ¨å†…å®¹ï¼Œå˜åŸºæ“ä½œå°†ä¼šç»ˆæ­¢ã€‚
#
# æ³¨æ„ç©ºæäº¤å·²è¢«æ³¨é‡Šæ‰
```

æ¯”å¦‚å°† 192c380 åˆå¹¶åˆ° e37786ea åˆ™å°† 192c380 å‰çš„ pick æ”¹ä¸º sæˆ–squash å³å¯
åˆå¹¶ç»“æŸåå†

```bash
git pull && git push
```

- [ ] å¦‚ä½•è§£å†³å†²çªï¼ˆconflict resolveï¼‰
- [ ] merge ä¸ rebase çš„åŒºåˆ«

---

## reset - æ¢å¤/å›é€€

ç‰ˆæœ¬å›é€€

- `git reset --(soft|mixed|hard) < HEAD ~(num) > |`

| æŒ‡ä»¤    | ä½œç”¨èŒƒå›´                                 |
| :------ | :--------------------------------------- |
| --hard  | å›é€€å…¨éƒ¨ï¼ŒåŒ…æ‹¬ HEADã€indexã€working tree |
| --mixed | å›é€€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ HEADã€index               |
| --soft  | å›é€€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ HEADã€index               |

```bash
# æ’¤é”€æš‚å­˜åŒºï¼ˆä¸è¦†ç›–å·¥ä½œåŒºï¼‰
git reset HEAD

# å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¸åˆ é™¤å·¥ä½œåŒºä»£ç ï¼Œæ’¤é”€ commitï¼Œä¸æ’¤é”€ add
git reset --soft HEAD^
# å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¸åˆ é™¤å·¥ä½œåŒºä»£ç ï¼Œæ’¤é”€ commit å’Œ add
git reset --mixed HEAD^
# å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œåˆ é™¤å·¥ä½œåŒºä»£ç ï¼Œæ’¤é”€ commit å’Œ add
git reset --hard HEAD^

# ä¿ç•™æ”¹åŠ¨ä»£ç ï¼Œä½†æ˜¯æ’¤é”€æœ€è¿‘ä¸€æ¬¡ git add å’Œ git commitï¼Œ^ åé¢å¯ä»¥è·Ÿæ•°å­—ï¼Œè¡¨ç¤ºæœ€è¿‘å‡ æ¬¡
git reset --mixed HEAD^
# ç­‰æ•ˆäº
git reset HEAD^

# åªæ’¤é”€ git commitï¼Œä¿ç•™ git add
git reset --soft HEAD^

# æ’¤é”€æœ€è¿‘ä¸€æ¬¡ git commit å’Œ git add
git reset --hard HEAD^

# ä¿®æ”¹æœ€è¿‘çš„ git commit message
git commit --amend

git log
# åªæ˜¾ç¤º commit id
git log --oneline
# å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œä¿ç•™ä¹‹åçš„æäº¤
git revert -n {version}

# åˆ é™¤å·²æäº¤çš„æ–‡ä»¶å¤¹ï¼Œç„¶åé‡æ–°æ‰§è¡Œä¸€ä¸‹ add å’Œ commit
git rm -r --cached .history .eslintcache
```

---

## checkout - åˆ‡æ¢/æ”¾å¼ƒ

```bash
git checkout --
# alias
git checkout .
```

---

## GitHub

create a new repository on the command line

```bash
echo "# hyper-annotated" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin https://github.com/zhuyudong/hyper-annotated.git
git push -u origin main
```

push an existing repository from the command line

```bash
git remote add origin https://github.com/zhuyudong/hyper-annotated.git
git branch -M main
git push -u origin main
```

[Git Tools](/git-tools)

[Git Examples](/git-examples)
